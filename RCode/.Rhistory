rr <- test(Dax_tap)
res
res
test <- function(Mkt,st){
res <- c(0,0,0,0,0)
ln <- nrow(Mkt)
for(i in st:ln){
mkt1 <- Mkt[1:i,]
lt_row <- nrow(mkt1)
r <- r_p(Dax_tap,lt_row)
res <- rbind(res,r)
browser()
}
return(res)
}
rr <- test(Dax_tap,3500)
res
res
test <- function(Mkt,st){
res <- c(0,0,0,0,0)
ln <- nrow(Mkt)
for(i in st:ln){
mkt1 <- Mkt[1:i,]
lt_row <- nrow(mkt1)
r <- r_p(Dax_tap,lt_row)
res <- rbind(res,r)
#browser()
}
return(res)
}
rr <- test(Dax_tap,3500)
rr
test <- function(Mkt,st){
res <- c(0,0,0,0,0)
colnames(res) <- c('a1','a2','a3','a4','pl')
ln <- nrow(Mkt)
for(i in st:ln){
mkt1 <- Mkt[1:i,]
lt_row <- nrow(mkt1)
r <- r_p(Dax_tap,lt_row)
res <- rbind(res,r)
#browser()
}
return(res)
}
rr <- test(Dax_tap,3500)
test <- function(Mkt,st){
res <- c(0,0,0,0,0)
ln <- nrow(Mkt)
for(i in st:ln){
mkt1 <- Mkt[1:i,]
lt_row <- nrow(mkt1)
r <- r_p(Dax_tap,lt_row)
res <- rbind(res,r)
#browser()
}
colnames(res) <- c('a1','a2','a3','a4','pl')
return(res)
}
rr <- test(Dax_tap,3500)
rr
sum(rr[rr$pl>0]
sum(rr[rr$pl>0])
sum(rr[pl>0])
rr$pl
str(rr)
test <- function(Mkt,st){
res <- as.data.frame(c(0,0,0,0,0))
ln <- nrow(Mkt)
for(i in st:ln){
mkt1 <- Mkt[1:i,]
lt_row <- nrow(mkt1)
r <- r_p(Dax_tap,lt_row)
res <- rbind(res,r)
#browser()
}
colnames(res) <- c('a1','a2','a3','a4','pl')
return(res)
}
rr <- test(Dax_tap,3500)
test <- function(Mkt,st){
res <- as.data.frame(c(0,0,0,0,0))
ln <- nrow(Mkt)
for(i in st:ln){
mkt1 <- Mkt[1:i,]
lt_row <- nrow(mkt1)
r <- r_p(Dax_tap,lt_row)
res <- rbind(res,r)
#browser()
}
colnames(res) <- c('a1','a2','a3','a4','pl')
return(res)
}
rr <- test(Dax_tap,3500)
test <- function(Mkt,st){
res <- as.data.frame(c(0,0,0,0,0))
ln <- nrow(Mkt)
for(i in st:ln){
mkt1 <- Mkt[1:i,]
lt_row <- nrow(mkt1)
r <- r_p(Dax_tap,lt_row)
res <- rbind(res,r)
browser()
}
colnames(res) <- c('a1','a2','a3','a4','pl')
return(res)
}
rr <- test(Dax_tap,3500)
res
res
test <- function(Mkt,st){
res <- as.data.frame(matrix(seq(11),nrow=1,ncol=5))
ln <- nrow(Mkt)
for(i in st:ln){
mkt1 <- Mkt[1:i,]
lt_row <- nrow(mkt1)
r <- r_p(Dax_tap,lt_row)
res <- rbind(res,r)
browser()
}
colnames(res) <- c('a1','a2','a3','a4','pl')
return(res)
}
rr <- test(Dax_tap,3500)
res
test <- function(Mkt,st){
res <- as.data.frame(matrix(seq(5),nrow=1,ncol=5))
ln <- nrow(Mkt)
for(i in st:ln){
mkt1 <- Mkt[1:i,]
lt_row <- nrow(mkt1)
r <- r_p(Dax_tap,lt_row)
res <- rbind(res,r)
browser()
}
colnames(res) <- c('a1','a2','a3','a4','pl')
return(res)
}
rr <- test(Dax_tap,3500)
res
res
test <- function(Mkt,st){
res <- as.data.frame(matrix(seq(5),nrow=1,ncol=5))
ln <- nrow(Mkt)
for(i in st:ln){
mkt1 <- Mkt[1:i,]
lt_row <- nrow(mkt1)
r <- r_p(Dax_tap,lt_row)
res <- rbind(res,r)
#browser()
}
colnames(res) <- c('a1','a2','a3','a4','pl')
res <- res[-1,]
return(res)
}
rr <- test(Dax_tap,3500)
rr$pl
sum(rr[pl>0])
sum(rr[rr$pl>0])
sum(rr[rr$pl>0,])
sum(ifelse(rr$a4>0,pl,-pl))
sum(ifelse(rr$a4>0,rr$pl,-rr$pl))
rr$pl2 <- ifelse(rr$a4>0,rr$pl,-rr$pl)
sum(rr$pl2)
rr <- test(Dax_tap,3000)
sum(ifelse(rr$a4>0,rr$pl,-rr$pl))
rr <- test(Dax_tap,2000)
sum(ifelse(rr$a4>0,rr$pl,-rr$pl))
nrow(rr)
sm <- sum(ifelse(rr$a4>0,rr$pl,-rr$pl))
sm <- sum(ifelse(rr$a4>0,rr$pl,-rr$pl));sm
sm / nrow(rr)
sum(rr$PL2>0, na.rm=T) / (sum(rr$PL2>0, na.rm=T) + sum(rr$PL2<0, na.rm=T))
rr$pl2 <- ifelse(rr$a4>0,rr$pl,-rr$pl)
sum(rr$PL2>0, na.rm=T) / (sum(rr$PL2>0, na.rm=T) + sum(rr$PL2<0, na.rm=T))
rr$pl2
sum(rr$PL2>0, na.rm=T)
sum(rr$PL2>0)
sum(rr$PL2>0,na.rm=T)
rr$pl2
sum(rr$pl2>0)
sum(rr$pl2>0) / (sum(rr$pl2>0, na.rm=T) + sum(rr$pl2<0, na.rm=T))
length(rr$pl2>0)
nrow(rr)
sum(length(rr$pl2>0))
rr$pl2>0
sum(rr$pl2>0)
sum(rr$pl2>0) / nrow(rr)
sum(rr$pl2)
sum(rr[rr$pl>0,])
sum(rr$pl2>0)
p <- rr$pl2[rr$pl2>0]
p
sum(p)
nrow(p)
length(p)
sum(p) / length(p)
neg <- rr$pl2[rr$pl2<0]
sum(neg)
length(neg)
sum(neg) / length(p)
sum(neg) / length(neg)
test2 <- function(Mkt,st){
res <- as.data.frame(matrix(seq(5),nrow=1,ncol=5))
ln <- nrow(Mkt)
for(i in st:ln){
bg <- (i - 300)
mkt1 <- Mkt[bg:i,]
lt_row <- nrow(mkt1)
r <- r_p(Dax_tap,lt_row)
res <- rbind(res,r)
#browser()
}
colnames(res) <- c('a1','a2','a3','a4','pl')
res <- res[-1,]
return(res)
}
rr <- test2(Dax_tap,2000)
sm <- sum(ifelse(rr$a4>0,rr$pl,-rr$pl));sm
sm / nrow(rr)
rr$pl2 <- ifelse(rr$a4>0,rr$pl,-rr$pl)
sum(rr$pl2>0) / (sum(rr$pl2>0, na.rm=T) + sum(rr$pl2<0, na.rm=T))
sum(rr$pl2>0) / nrow(rr)
rr$pl2
rr
test2 <- function(Mkt,st){
res <- as.data.frame(matrix(seq(5),nrow=1,ncol=5))
ln <- nrow(Mkt)
for(i in st:ln){
bg <- (i - 300)
mkt1 <- Mkt[bg:i,]
lt_row <- nrow(mkt1)
r <- r_p(Dax_tap,lt_row)
res <- rbind(res,r)
browser()
}
colnames(res) <- c('a1','a2','a3','a4','pl')
res <- res[-1,]
return(res)
}
rr <- test2(Dax_tap,2000)
res
i
bg
lt_row
test2 <- function(Mkt,st){
res <- as.data.frame(matrix(seq(5),nrow=1,ncol=5))
ln <- nrow(Mkt)
for(i in st:ln){
bg <- (i - 300)
mkt1 <- Mkt[bg:i,]
lt_row <- nrow(mkt1)
r <- r_p(Dax_tap,i)
res <- rbind(res,r)
browser()
}
colnames(res) <- c('a1','a2','a3','a4','pl')
res <- res[-1,]
return(res)
}
rr <- test2(Dax_tap,2000)
res
test2 <- function(Mkt,st){
res <- as.data.frame(matrix(seq(5),nrow=1,ncol=5))
ln <- nrow(Mkt)
for(i in st:ln){
bg <- (i - 300)
mkt1 <- Mkt[bg:i,]
lt_row <- nrow(mkt1)
r <- r_p(Dax_tap,i)
res <- rbind(res,r)
#browser()
}
colnames(res) <- c('a1','a2','a3','a4','pl')
res <- res[-1,]
return(res)
}
rr <- test2(Dax_tap,2000)
sm <- sum(ifelse(rr$a4>0,rr$pl,-rr$pl));sm
sm / nrow(rr)
rr$pl2 <- ifelse(rr$a4>0,rr$pl,-rr$pl)
sum(rr$pl2>0) / (sum(rr$pl2>0, na.rm=T) + sum(rr$pl2<0, na.rm=T))
sum(rr$pl2>0) / nrow(rr)
source("../RCode/Utils.R")
source("../RCode/ts_1.R")
source("../RCode/ts_2.R")
source("../RCode/ts_3.R")
source("../RCode/ts_3a.R")
source("../RCode/ts_4.R")
#source("ts_1.R")
#source("ts_2.R")
#source("Utils.R")
fil <- c("../Data/Dax_2000_d.csv",
"../Data/CAC_2000_d.csv",
"../Data/F100_2000_d.csv",
"../Data/Dow_2000_d.csv",
"../Data/N225_2000_d.csv",
"../Data/Oz_2000.csv")
setwd("D:/Allan/DropBox/MSc/Dissertation/Thesis/RCode")
source("../RCode/Utils.R")
source("../RCode/ts_1.R")
source("../RCode/ts_2.R")
source("../RCode/ts_3.R")
source("../RCode/ts_3a.R")
source("../RCode/ts_4.R")
#source("ts_1.R")
#source("ts_2.R")
#source("Utils.R")
fil <- c("../Data/Dax_2000_d.csv",
"../Data/CAC_2000_d.csv",
"../Data/F100_2000_d.csv",
"../Data/Dow_2000_d.csv",
"../Data/N225_2000_d.csv",
"../Data/Oz_2000.csv")
df10 <- as.data.frame(matrix(seq(11),nrow=1,ncol=11))
ts_1_fnc <- function(fil,nm,ts1){
for(i in 1:length(fil)){
Mkt <- read.csv(fil[i])
Mkt_ts <- ts(Mkt$Close)
Mkt_train <- window(Mkt_ts, end=2999.99)
Mkt_test <- window(Mkt_ts, start=3000)
arima_train_mod <- auto.arima(Mkt_train)
arima_fcast <- forecast.Arima(arima_train_mod,Mkt_test)
arima_test_mod <- Arima(Mkt_test, model = arima_train_mod) # 1 step fcast on future data ...
arima_test_fcast <- forecast(arima_test_mod)
fitted.data <- as.data.frame(arima_test_fcast$fitted);
ln <- nrow(Mkt)
lw <- nrow(fitted.data)
Mkt_test_df <- Mkt[(ln-lw+1):ln,]
Mkt_test_df <- cbind(Mkt_test_df,fitted.data)
colnames(Mkt_test_df) <- c("Date","Open", "High","Low","Close","p")
if(ts1 == TRUE){
a <- ts_1(Mkt_test_df, 0, nm[i]) # System 1
} else {
a <- ts_2(Mkt_test_df, 0, nm[i]) # System 2
}
df10 <- rbind(df10, a)
}
df.name <- names(a)
names(df10) <- df.name
df10 <- df10[-c(1),]
return(df10)
}
res <- ts_1_fnc(fil,nm,TRUE)
library(forecast)
library(xtable)
res <- ts_1_fnc(fil,nm,TRUE)
res
source("../RCode//NaiveFollowPrev.R")
df10 <- as.data.frame(matrix(seq(11),nrow=1,ncol=11))
run_NaiveLongSystem2 <- function(fil,SLoss, nm){
df10 <- as.data.frame(matrix(seq(11),nrow=1,ncol=11))
for(i in 1:length(fil)){
Dax <- read.csv(fil[i])
a <- NaiveLongSystem2(Dax, 0, nm[i])
df10 <- rbind(df10, a)
}
df.name <- names(a)
names(df10) <- df.name
df10 <- df10[-1,]
return(df10)
}
NaiveRev <- run_NaiveLongSystem2(fil,0,nm)
source("../RCode//NaiveFollowPrev.R")
NaiveRev <- run_NaiveFollowPrev(fil, 0, nm)
NaiveRev
df10 <- as.data.frame(matrix(seq(11),nrow=1,ncol=11))
ts_1_fnc <- function(fil,nm,ts1){
for(i in 1:length(fil)){
Mkt <- read.csv(fil[i])
Mkt_ts <- ts(Mkt$Close)
Mkt_train <- window(Mkt_ts, end=2999.99)
Mkt_test <- window(Mkt_ts, start=3000)
arima_train_mod <- auto.arima(Mkt_train)
arima_fcast <- forecast.Arima(arima_train_mod,Mkt_test)
arima_test_mod <- Arima(Mkt_test, model = arima_train_mod) # 1 step fcast on future data ...
arima_test_fcast <- forecast(arima_test_mod)
fitted.data <- as.data.frame(arima_test_fcast$fitted);
ln <- nrow(Mkt)
lw <- nrow(fitted.data)
Mkt_test_df <- Mkt[(ln-lw+1):ln,]
Mkt_test_df <- cbind(Mkt_test_df,fitted.data)
colnames(Mkt_test_df) <- c("Date","Open", "High","Low","Close","p")
if(ts1 == TRUE){
a <- ts_1(Mkt_test_df, 0, nm[i]) # System 1
} else {
a <- ts_2(Mkt_test_df, 0, nm[i]) # System 2
}
df10 <- rbind(df10, a)
}
df.name <- names(a)
names(df10) <- df.name
df10 <- df10[-c(1),]
return(df10)
}
# run the fnc ts_1
# apply Sys 1 to the auto.arima data
res <- ts_1_fnc(fil,nm,TRUE)
diff <- sub_df(NaiveRev,res)
diff
diff <- sub_df(res,NaiveRev)
diff
dat <- diff[,c(1,7,10)]
dig <- 0
cap <- c("Auto.arima models compared to Naive Reverse",
"Auto.arima models compared to Naive Reverse")
lab = 'tab:chp_ts:arima1_diff'
filname ='../Tables/chp_ts_arima1_diff.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
source("../RCode/Utils.R")
diff_df <- sub_df_av_pl(res,NaiveRev)
source("../RCode/Utils.R")
source("../RCode/Utils.R")
diff_df <- sub_df_av_pl(res,NaiveRev)
diff_df
dat <- diff_df
dig <- 0
cap <- c("Auto.arima models compared to Naive Reverse",
"Auto.arima models compared to Naive Reverse")
lab = 'tab:chp_ts:arima1_diff'
filname ='../Tables/chp_ts_arima1_diff.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dat <- diff_df
dig <- 0
cap <- c("Mean Long/Short PL from Naive Reverse subtracted from PL generated by auto.arima models",
"Mean PL from Auto.arima models inus mean PL from Naive Reverse system")
lab = 'tab:chp_ts:arima1_diff'
filname ='../Tables/chp_ts_arima1_diff.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
source("../RCode/Utils.R")
diff_df <- sub_df_av_pl(res,NaiveRev)
dat <- diff_df
dig <- 0
cap <- c("Mean Long/Short PL from Naive Reverse subtracted from PL generated by auto.arima models",
"Mean PL from Auto.arima models inus mean PL from Naive Reverse system")
lab = 'tab:chp_ts:arima1_diff'
filname ='../Tables/chp_ts_arima1_diff.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
cap <- c("Mean Long/Short PL from Naive Reverse system subtracted from PL generated by auto.arima models",
"Mean PL from Auto.arima models inus mean PL from Naive Reverse system")
lab = 'tab:chp_ts:arima1_diff'
filname ='../Tables/chp_ts_arima1_diff.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
fil <- c("../Data/ARIMA/Predict_Close/ar334_knn_Dax.csv",
"../Data/ARIMA/Predict_Close/ar334_knn_CAC.csv",
"../Data/ARIMA/Predict_Close/ar334_knn_F100.csv",
"../Data/ARIMA/Predict_Close/ar334_knn_Dow.csv",
"../Data/ARIMA/Predict_Close/ar334_knn_Nik.csv",
"../Data/ARIMA/Predict_Close/ar334_knn_Oz.csv")
df10 <- as.data.frame(matrix(seq(11),nrow=1,ncol=11))
# a. System 1
res <- ts_1_2_fnc_ar(fil,nm,TRUE)
ts_1_2_fnc_ar <- function(fil,nm,ts1){
for(i in 1:length(fil)){
Mkt <- read.csv(fil[i],stringsAsFactors=F)
Mkt_p <- Mkt[,c(1,2,3,4,5,18)]
colnames(Mkt_p) <- c("Date","Open", "High","Low","Close","p")
if(ts1 == TRUE){
a <- ts_1(Mkt_p, 0, nm[i])
} else {
a <- ts_2(Mkt_p, 0, nm[i])
}
df10 <- rbind(df10, a)
}
df.name <- names(a)
names(df10) <- df.name
df10 <- df10[-c(1),]
return(df10)
}
res <- ts_1_2_fnc_ar(fil,nm,TRUE)
dat <- res[,c(1,3,4,5,7,8,10)]
dig <- 0
cap <- c("Predicting Close Price - Arima/k-NN predictions passed to System 1",
"Predicting Close Price - Arima/k-NN predictions passed to System 1.")
lab = 'tab:chp_ts:pred_close_arima_knn_sys1'
filname ='../Tables/chp_ts_pred_close_arima_knn_sys1.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
cap <- c("Predicting Close Price - Arima/k-NN predictions passed to System 1.",
"Predicting Close Price - Arima/k-NN predictions passed to System 1.")
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
fil <- c("../Data/ARIMA/PredUpDn_CAT/ar_334_UD_knn_Dax.csv",
"../Data/ARIMA/PredUpDn_CAT/ar_334_UD_knn_CAC.csv",
"../Data/ARIMA/PredUpDn_CAT/ar_334_UD_knn_F100.csv",
"../Data/ARIMA/PredUpDn_CAT/ar_334_UD_knn_Dow.csv",
"../Data/ARIMA/PredUpDn_CAT/ar_334_UD_knn_N225.csv",
"../Data/ARIMA/PredUpDn_CAT/ar_334_UD_knn_Oz.csv")
df10 <- as.data.frame(matrix(seq(11),nrow=1,ncol=11))
res <- ts_4_fnc_ar(fil, 0, nm)
res
dat <- res[,c(1,3,4,5,7,8,10)]
dig <- 0
cap <- c("Predicting UpDn CAT - Arima/k-NN predictions passed to System 4",
"Predicting UpDn CAT - Arima/k-NN predictions passed to System 4.")
lab = 'tab:chp_ts:pUD_CAT_arima_knn_sys'
filname ='../Tables/chp_ts_predUpDn_CAT_arima_knn_sys.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
res <- ts_4_fnc_ar(fil, -100, nm)
dat <- res[,c(1,3,4,5,7,8,10)]
dig <- 0
cap <- c("Predicting UpDn CAT - Arima/k-NN predictions passed to System 4 - SLoss",
"Predicting UpDn CAT - Arima/k-NN predictions passed to System 4 - SLoss")
lab = 'tab:chp_ts:pUD_CAT_arima_knn_sys_SL'
filname ='../Tables/chp_ts_predUpDn_CAT_arima_knn_sys_SL.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
