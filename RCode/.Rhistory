d <- ad_df(Mkta,ad,df);d
e <- os_df(Mkta,os,df);e
c+ d + e
f
Mkt <- Mkt[1:(nr-3),]
nr <- nrow(Mkt);nr
Mkt$Date[nr]
tail(Mkt)
au <- Mkt$aroonUp[nr -1] ;au
ad <- Mkt$aroonDn[nr - 1] ;ad
os <- Mkt$oscillator[nr-1] ;os
df <- Mkt$Diff[nr-1]  ;df
f <- Mkt$pl[nr]
Mkta <- Mkt[-nr,]
c <- au_df(Mkta,au,df);c
d <- ad_df(Mkta,ad,df);d
e <- os_df(Mkta,os,df);e
c+ d + e
f
Mkt <- Mkt[1:(nr-3),]
nr <- nrow(Mkt);nr
Mkt$Date[nr]
au <- Mkt$aroonUp[nr -1] ;au
ad <- Mkt$aroonDn[nr - 1] ;ad
os <- Mkt$oscillator[nr-1] ;os
df <- Mkt$Diff[nr-1]  ;df
f <- Mkt$pl[nr]
Mkta <- Mkt[-nr,]
c <- au_df(Mkta,au,df);c
d <- ad_df(Mkta,ad,df);d
e <- os_df(Mkta,os,df);e
c+ d + e
f
Mkt <- Mkt[1:(nr-3),]
nr <- nrow(Mkt);nr
Mkt$Date[nr]
au <- Mkt$aroonUp[nr -1] ;au
ad <- Mkt$aroonDn[nr - 1] ;ad
os <- Mkt$oscillator[nr-1] ;os
df <- Mkt$Diff[nr-1]  ;df
f <- Mkt$pl[nr]
Mkta <- Mkt[-nr,]
c <- au_df(Mkta,au,df);c
d <- ad_df(Mkta,ad,df);d
e <- os_df(Mkta,os,df);e
c+ d + e
f
Mkt <- Mkt[1:(nr-3),]
nr <- nrow(Mkt);nr
Mkt$Date[nr]
au <- Mkt$aroonUp[nr -1] ;au
ad <- Mkt$aroonDn[nr - 1] ;ad
os <- Mkt$oscillator[nr-1] ;os
df <- Mkt$Diff[nr-1]  ;df
f <- Mkt$pl[nr]
Mkta <- Mkt[-nr,]
c <- au_df(Mkta,au,df);c
d <- ad_df(Mkta,ad,df);d
e <- os_df(Mkta,os,df);e
c+ d + e
f
Mkt <- Mkt[1:(nr-3),]
nr <- nrow(Mkt);nr
Mkt$Date[nr]
au <- Mkt$aroonUp[nr -1] ;au
ad <- Mkt$aroonDn[nr - 1] ;ad
os <- Mkt$oscillator[nr-1] ;os
df <- Mkt$Diff[nr-1]  ;df
f <- Mkt$pl[nr]
Mkta <- Mkt[-nr,]
c <- au_df(Mkta,au,df);c
d <- ad_df(Mkta,ad,df);d
e <- os_df(Mkta,os,df);e
c+ d + e
f
Mkt <- Mkt[1:(nr-3),]
nr <- nrow(Mkt);nr
Mkt$Date[nr]
au <- Mkt$aroonUp[nr -1] ;au
ad <- Mkt$aroonDn[nr - 1] ;ad
os <- Mkt$oscillator[nr-1] ;os
df <- Mkt$Diff[nr-1]  ;df
f <- Mkt$pl[nr]
Mkta <- Mkt[-nr,]
c <- au_df(Mkta,au,df);c
d <- ad_df(Mkta,ad,df);d
e <- os_df(Mkta,os,df);e
c+ d + e
f
Mkt <- Mkt[1:(nr-3),]
nr <- nrow(Mkt);nr
Mkt$Date[nr]
au <- Mkt$aroonUp[nr -1] ;au
ad <- Mkt$aroonDn[nr - 1] ;ad
os <- Mkt$oscillator[nr-1] ;os
df <- Mkt$Diff[nr-1]  ;df
f <- Mkt$pl[nr]
Mkta <- Mkt[-nr,]
c <- au_df(Mkta,au,df);c
d <- ad_df(Mkta,ad,df);d
e <- os_df(Mkta,os,df);e
c+ d + e
f
Mkt <- Mkt[1:(nr-3),]
nr <- nrow(Mkt);nr
Mkt$Date[nr]
au <- Mkt$aroonUp[nr -1] ;au
ad <- Mkt$aroonDn[nr - 1] ;ad
os <- Mkt$oscillator[nr-1] ;os
df <- Mkt$Diff[nr-1]  ;df
f <- Mkt$pl[nr]
Mkta <- Mkt[-nr,]
c <- au_df(Mkta,au,df);c
d <- ad_df(Mkta,ad,df);d
e <- os_df(Mkta,os,df);e
c+ d + e
f
Mkt <- Mkt[1:(nr-3),]
nr <- nrow(Mkt);nr
Mkt$Date[nr]
au <- Mkt$aroonUp[nr -1] ;au
ad <- Mkt$aroonDn[nr - 1] ;ad
os <- Mkt$oscillator[nr-1] ;os
df <- Mkt$Diff[nr-1]  ;df
f <- Mkt$pl[nr]
Mkta <- Mkt[-nr,]
c <- au_df(Mkta,au,df);c
d <- ad_df(Mkta,ad,df);d
e <- os_df(Mkta,os,df);e
c+ d + e
f
Mkt <- Mkt[1:(nr-3),]
nr <- nrow(Mkt);nr
Mkt$Date[nr]
au <- Mkt$aroonUp[nr -1] ;au
ad <- Mkt$aroonDn[nr - 1] ;ad
os <- Mkt$oscillator[nr-1] ;os
df <- Mkt$Diff[nr-1]  ;df
f <- Mkt$pl[nr]
Mkta <- Mkt[-nr,]
c <- au_df(Mkta,au,df);c
d <- ad_df(Mkta,ad,df);d
e <- os_df(Mkta,os,df);e
c+ d + e
f
dat <- res8[,std6]
dig <- 2
cap =  c('Results from a system based on the SAR indicator.',
'Results from a system based on the SAR indicator')
lab = 'tab:sar_results'
filname ='../Tables/chp_ta_sar.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
setwd("D:/Allan/DropBox/MSc/Dissertation/Thesis/RCode")
# Housekeeping
library(xtable)
library(TTR)
library(candlesticks)
dat <- res8[,std6]
dig <- 2
cap =  c('Results from a system based on the SAR indicator.',
'Results from a system based on the SAR indicator')
lab = 'tab:sar_results'
filname ='../Tables/chp_ta_sar.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
# produce latex table
dat <- res1[,c(1,3,5,7)]
dig <- 2
cap = c('Naive Long System. A very simple system in which the algorithm assumes the market will rise and enters a long trade each day.',
'Results from the Naive Long System')
lab = 'tab:nlng_results'
filname ='../Tables/chp_ta_naive_long.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
cap = c('Naive Long System changed such that the trading period is the previous close price minus today\'s close.',
'Results from the Naive Long System trading close to close')
lab = 'tab:nlng_results_2'
filname ='../Tables/chp_ta_naive_long_ctoc.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dat <- res3[,c(1,3,4,5,7,8,10)]
dig <- 2
cap = c('Naive system which reverses the previous day\'s trade direction.',
'Results from the Naive Reversing System.')
lab = 'tab:ntfresults'
filname ='../Tables/chp_ta_naive_follow_prev.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dat <- res3[,c(1,3,4,5,7,8,10)]
dig <- 2
cap = c('Naive system which reverses the previous day\'s trade direction.',
'Results from the Naive Reversing System.')
lab = 'tab:ntfresults'
filname ='../Tables/chp_ta_naive_follow_prev.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dat <- res4[,c(1,3,4,5,7,8,10,11)]
dig <- 2
cap = c('Results from a system based on SMA.',
'Results from a system based on SMA')
lab = 'tab:sma_results'
filname ='../Tables/chp_ta_sma.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dat <- res5[,c(1,2,3,4,5,6,8,9,11)]
dig <- 2
cap =  c('Results from a system based on SMA with stop loss.',
'Results from a system based on SMA with stop loss')
lab = 'tab:sma_results_Sloss'
filname ='../Tables/chp_ta_sma_sloss.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dat <- res3[,c(1,3,4,5,7,8,10)]
dig <- 2
cap = c('Results from a naive system which reverses the previous day\'s trade direction.',
'Results from the Naive Reversing System.')
lab = 'tab:ntfresults'
filname ='../Tables/chp_ta_naive_follow_prev.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
# produce latex table
dat <- res3[,c(1,3,4,5,7,8,10)]
dig <- 2
cap = c('Results from a naive trading system which simply trades in the opposite direction to the previous day\'s movement.',
'Results from the Naive Reversing System.')
lab = 'tab:ntfresults'
filname ='../Tables/chp_ta_naive_follow_prev.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dat <- res9[,std6]
dig <- 2
cap =  c('Results from a trading system based on MACD being used as a trend reveral indicator.',
'Results from a system based on MACD as trend reversal indicator')
lab = 'tab:mac_ob_results'
filname ='../Tables/chp_ta_macd_ob.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dat <- res10[,std6]
dig <- 2
cap =  c('Results from a system based on the Stochastic indicator.',
'Results from a system based on the Stochastic indicator')
lab = 'tab:stoch_results'
filname ='../Tables/chp_ta_stoch.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dat <- res10a[,std6]
dig <- 2
cap =  c('Results from a system based on the Stochastic indicator with a Stop Loss.',
'Results from a system based on the Stochastic indicator with a Stop Loss')
lab = 'tab:stoch_results_sloss'
filname ='../Tables/chp_ta_stoch_sloss.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dig <- 2
cap =  c('Results from a system based on the Stochastic indicator with a stop loss.',
'Results from a system based on the Stochastic indicator with a stop loss')
lab = 'tab:stoch_results_sloss'
filname ='../Tables/chp_ta_stoch_sloss.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dig <- 2
cap =  c('Results from a system based on the Stochastic indicator with a stop loss.',
'Results from a system based on the Stochastic indicator with a stop loss')
lab = 'tab:stoch_results_sloss'
filname ='../Tables/chp_ta_stoch_sloss.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dat <- res11[,std6]
dig <- 2
cap =  c('Results from a system based on the ROC indicator.',
'Results from a system based on the ROC indicator')
lab = 'tab:mac_roc_results'
filname ='../Tables/chp_ta_roc.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dat <- res12[,std6]
dig <- 2
cap =  c('Results from the Daily High / Low Breakout System.',
'Results from the Daily High / Low Breakout System')
lab = 'tab:hl_bout_sys'
filname ='../Tables/chp_ta_b_out.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dat <- res14[,std6]
dig <- 2
cap =  c('Results from a system that breaks out from the 90\\% quantile level of the day\'s minot move.',
'Results from a break out system using the 90\\% quantile of the minor move')
lab = 'tab:q_90_results'
filname ='../Tables/chp_ta_90q.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
cap =  c('Results from a system that breaks out from the 90\\% quantile level of the day\'s minor move.',
'Results from a break out system using the 90\\% quantile of the minor move')
lab = 'tab:q_90_results'
filname ='../Tables/chp_ta_90q.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
cap =  c('Results from a system that breaks out from the 90\\% quantile level of the day\'s minor move.',
'Results from a break out system using the day\'s the minor move')
lab = 'tab:q_90_results'
filname ='../Tables/chp_ta_90q.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dat <- res14[,c(1,3,5,6,7)]
dig <- 2
cap = c('Results from a system based on the Hammer and Inverted Hammer candlestick patterns.',
'Results from a system based on the Hammer and Inverted Hammer candlestick patterns')
lab = 'tab:hammer_results'
filname ='../Tables/chp_ta_hammer.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
# latex table
dat <- res14a[,c(1,3,5,6,7)]
dig <- 2
cap =  c('Results from a system based on the Hammer and Inverted Hammer candlestick patterns occurring in a downtrend as defined by the aroon value.',
'Results from a system based on the Hammer and Inverted Hammer candlestick patterns occurring in a downtrend')
lab = 'tab:hammer_aroon_results'
filname ='../Tables/chp_ta_hammer_d_trend.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dat <- res15[,std6]
dig <- 2
cap =  c('Results from a system based on the Engulfing candlestick pattern.',
'Results from a system based on the Engulfing candlestick pattern')
lab = 'tab:engulf_results'
filname ='../Tables/chp_ta_englf.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dat <- res15a[,std6]
dig <- 2
cap =  c('Results from a system based on the Engulfing candlestick pattern in a trending market.',
'Results from a system based on the Engulfing candlestick pattern in a trending market')
lab = 'tab:engulf_aroon_results'
filname ='../Tables/chp_ta_englf_aroon.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
dat <- res16[,std6]
dig <- 2
cap = c('Results from a system based on the Doji candlestick pattern in a trending market.',
'Results from a system based on the Doji candlestick pattern in a trending market')
lab = 'tab:doji_aroon_results'
filname ='../Tables/chp_ta_doji.tex'
inclrnam=FALSE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
setwd("D:/Allan/DropBox/MSc/Dissertation/Thesis/RCode")
source("../RCode/Utils.R")
source("../RCode/ts_1.R")
source("../RCode/ts_2.R")
source("../RCode/ts_3.R")
source("../RCode/ts_3a.R")
source("../RCode/ts_4.R")
source("../RCode//NaiveFollowPrev.R")
fil <- c("../Data/Dax_2000_d.csv",
"../Data/CAC_2000_d.csv",
"../Data/F100_2000_d.csv",
"../Data/Dow_2000_d.csv",
"../Data/N225_2000_d.csv",
"../Data/Oz_2000.csv")
#nm <- c("Dax", "CAC", "FTSE", "Dow", "Nikkei", "AORD")
# Add Naive follow prev for comparison purposes
# data frame will be fed into sub_df
df10 <- as.data.frame(matrix(seq(11),nrow=1,ncol=11))
NaiveRev <- run_NaiveFollowPrev(fil, 0, nm)
mod_ar <- function(Mkt, ord, nm){
res <- t(as.data.frame(rep(0,4)))
mod <- Arima(Mkt_ts, order=ord)
res[1,1] <- nm
res[1,2] <- round(mod$aic,1)
res[1,3] <- round(mod$aicc,1)
res[1,4] <- round(mod$bic,1)
return(res)
}
results <- t(as.data.frame(rep(0,4)))
colnames(results) <- c('Model','AIC','AICc','BIC')
r2 <- mod_ar(Mkt_train, c(3,1,1), 'Arima(3,1,1)')
results <- rbind(results,r2)
r2 <- mod_ar(Mkt_train, c(3,1,2), 'Arima(3,1,2)')
results <- rbind(results,r2)
r2 <- mod_ar(Mkt_train, c(3,1,3), 'Arima(3,1,3)')
results <- rbind(results,r2)
r2 <- mod_ar(Mkt_train, c(2,1,1), 'Arima(2,1,1)')
results <- rbind(results,r2)
r2 <- mod_ar(Mkt_train, c(2,1,2), 'Arima(2,1,2)')
results <- rbind(results,r2)
r2 <- mod_ar(Mkt_train, c(2,1,3), 'Arima(2,1,3)')
results <- rbind(results,r2)
results <- results[-1,]
library(forecast)
r2 <- mod_ar(Mkt_train, c(3,1,1), 'Arima(3,1,1)')
library(forecast)
r2 <- mod_ar(Mkt_train, c(3,1,1), 'Arima(3,1,1)')
r2 <- mod_ar(Mkt_train, c(3,1,1), 'Arima(3,1,1)')
mod_ar <- function(Mkt_ts, ord, nm){
res <- t(as.data.frame(rep(0,4)))
mod <- Arima(Mkt_ts, order=ord)
res[1,1] <- nm
res[1,2] <- round(mod$aic,1)
res[1,3] <- round(mod$aicc,1)
res[1,4] <- round(mod$bic,1)
return(res)
}
results <- t(as.data.frame(rep(0,4)))
colnames(results) <- c('Model','AIC','AICc','BIC')
r2 <- mod_ar(Mkt_train, c(3,1,1), 'Arima(3,1,1)')
Mkt <- read.csv("../Data/F100_2000_d.csv")
Mkt_ts <- ts(Mkt$Close)
Mkt_train <- window(Mkt_ts, end=2999.99)
Mkt_test <- window(Mkt_ts, start=3000)
mod_ar <- function(Mkt_ts, ord, nm){
res <- t(as.data.frame(rep(0,4)))
mod <- Arima(Mkt_ts, order=ord)
res[1,1] <- nm
res[1,2] <- round(mod$aic,1)
res[1,3] <- round(mod$aicc,1)
res[1,4] <- round(mod$bic,1)
return(res)
}
results <- t(as.data.frame(rep(0,4)))
colnames(results) <- c('Model','AIC','AICc','BIC')
r2 <- mod_ar(Mkt_train, c(3,1,1), 'Arima(3,1,1)')
results <- rbind(results,r2)
r2 <- mod_ar(Mkt_train, c(3,1,2), 'Arima(3,1,2)')
results <- rbind(results,r2)
r2 <- mod_ar(Mkt_train, c(3,1,3), 'Arima(3,1,3)')
results <- rbind(results,r2)
r2 <- mod_ar(Mkt_train, c(2,1,1), 'Arima(2,1,1)')
results <- rbind(results,r2)
r2 <- mod_ar(Mkt_train, c(2,1,2), 'Arima(2,1,2)')
results <- rbind(results,r2)
r2 <- mod_ar(Mkt_train, c(2,1,3), 'Arima(2,1,3)')
results <- rbind(results,r2)
results <- results[-1,]
dat <- results
dig <- c(0,0,2,2,2)
cap <- c("AIC, AICc and BIC results from alternative ARIMA models.",
"AIC, AICc and BIC results from alternative ARIMA models")
lab = 'tab:chp_ts:arima_res_r'
filname ='../Tables/chp_ts_arima_res_r.tex'
inclrnam=F
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
bb <- Box.test(residuals(model_used_for_res), lag=24, fitdf=4, type="Ljung")
results_bc <- as.data.frame(rep(0,3))
results_bc[1,1] <- round(bb$p.value,4)
results_bc[2,1] <- round(bb$parameter)
results_bc[3,1] <- round(bb$statistic)
#colnames(results_bc) <- c(paste(bb$method,forecast(model_311)$method))
colnames(results_bc) <- c(forecast(model_used_for_res)$method)
rownames(results_bc) <- c('p-value','x-squared','df')
#results_bc[1,1]
results_bc_t <- t(results_bc)
model_used_for_res <- Arima(Mkt_train, order=c(2,1,3))
model_name <- forecast(model_used_for_res)$method
# a mean of residual
residual <- model_used_for_res$residuals
savepdf("chp_ts_ftse_2000-13_mean_residuals")
plot(residual, main = paste("Residuals from model of", model_name),
ylab="", xlab="Day")
dev.off()
# b. acf of residual
savepdf("chp_ts_ftse_2000-13_acf_residuals")
Acf(residuals(model_used_for_res),
main= paste("ACF of Residuals of", model_name))
dev.off()
# c. variance - use plot from a
# d. histogram of residuals - normal distribution
savepdf("chp_ts_ftse_2000-13_hist_residuals")
hist(residual, nclass="FD", main="Histogram of residuals")
dev.off()
bb <- Box.test(residuals(model_used_for_res), lag=24, fitdf=4, type="Ljung")
results_bc <- as.data.frame(rep(0,3))
results_bc[1,1] <- round(bb$p.value,4)
results_bc[2,1] <- round(bb$parameter)
results_bc[3,1] <- round(bb$statistic)
#colnames(results_bc) <- c(paste(bb$method,forecast(model_311)$method))
colnames(results_bc) <- c(forecast(model_used_for_res)$method)
rownames(results_bc) <- c('p-value','x-squared','df')
#results_bc[1,1]
results_bc_t <- t(results_bc)
dat <- results_bc_t
dig <- c(0,4,0,0)
cap <- c("Box Ljung test of FTSE 100 ARIMA model residuals.",
"Box Ljung test of FTSE 100 ARIMA model residuals")
lab = 'tab:chp_ts:arima_res_rbox_l'
filname ='../Tables/chp_ts_arima_res_r_box_l.tex'
inclrnam=TRUE
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
model_name <- forecast(model_used_for_res)$method
arima_man_fcast <- forecast.Arima(model_used_for_res,Mkt_test)
fitted.data <- as.data.frame(arima_man_fcast$fitted);
#ln <- nrow(Mkt)
#lw <- nrow(fitted.data)
#Mkt_test_df <- Mkt[(ln-lw+1):ln,]
Mkt_test_df <- cbind(Mkt,fitted.data)
colnames(Mkt_test_df) <- c('Date','Open','High','Low','Close','Forecast')
model_used_for_res <- Arima(Mkt_ts, order=c(2,1,3))
model_name <- forecast(model_used_for_res)$method
arima_man_fcast <- forecast.Arima(model_used_for_res,Mkt_test)
fitted.data <- as.data.frame(arima_man_fcast$fitted);
#ln <- nrow(Mkt)
#lw <- nrow(fitted.data)
#Mkt_test_df <- Mkt[(ln-lw+1):ln,]
Mkt_test_df <- cbind(Mkt,fitted.data)
colnames(Mkt_test_df) <- c('Date','Open','High','Low','Close','Forecast')
dat <- tail(Mkt_test_df)
dig <- 0
cap <- c("One step ahead forecast for FTSE 100 generated from ARIMA(2,1,3) model.",
"Forecast for FTSE 100 generated from the ARIMA model")
lab = 'tab:chp_ts:ftse_100_fcast'
filname ='../Tables/chp_ts_ftse_100_fcast.tex'
inclrnam=F
print_xt(dat,dig,cap,lab,al,filname,inclrnam)
